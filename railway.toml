# Railway.toml - Production Configuration for vttless
# This file configures Railway deployment for the main backend service
# For multi-service deployment, see individual railway.*.toml files

[build]
builder = "dockerfile"
dockerfilePath = "Dockerfile.backend"

[deploy]
numReplicas = 1
sleepApplication = false
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# Health check configuration
healthcheckPath = "/health"
healthcheckTimeout = 100

# Deployment regions (Railway will auto-select if not specified)
# regions = ["us-west1", "us-east1", "eu-west1"]

[build.watchPaths]
# Watch these paths for changes to trigger redeploy
include = [
    "backend/**",
    "Dockerfile.backend",
    "package.json",
    "package-lock.json",
    "yarn.lock"
]
ignore = [
    "client/**",
    "eventserver/**",
    "tests/**",
    "docs/**",
    "extension/**",
    "uploads/**",
    "coverage/**",
    "*.log",
    "*.md",
    ".github/**"
]

# Environment-specific overrides
[deploy.environment]
NODE_ENV = "production"

# Production environment variables (set via Railway UI, not here)
# - MONGODB_URI: Production MongoDB connection string
# - JWT_SECRET_KEY: Secure JWT signing key
# - JWT_REFRESH_SECRET_KEY: Secure JWT refresh signing key
# - AWS_ACCESS_KEY_ID: AWS S3 access key
# - AWS_SECRET_ACCESS_KEY: AWS S3 secret key
# - AWS_REGION: AWS region (e.g., us-east-1)
# - S3_BUCKET_NAME: S3 bucket for file uploads
# - CLIENT_URL: Production client URL
# - COOKIE_DOMAIN: Cookie domain for production
# - PORT: Server port (auto-set by Railway)
